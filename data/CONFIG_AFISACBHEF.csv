NUM,GRUPO,EJECUCION,TEMA,TIPO,TIPO_TABLA,CONDICION,DESC_REGLA,VALOR_SI,VALOR_NO,NUEVO_CAMPO,TIPO_DATO,DESC_FUNCIONAL,PARTICION,ACTIVA,FECDESDE,FECHASTA,PERIODICIDAD,OBJETIVO,DESCRIPCION
1,AFISACBHEF,AFISACBHEF01,$TMPBOR.TMP_AFISACBHEF01,Codigo,INSERTTMP,SELECT,"cve_sucursal,num_cuenta_contrato,cve_moneda,fec_posicion_efectivo,cast(max(to_date(fec_particion_datos))as TIMESTAMP) fec_particion_datos",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
1,AFISACBHEF,AFISACBHEF01,$TMPBOR.TMP_AFISACBHEF01,Tabla,INSERTTMP,FROM,$AFOPICS.det_historial_saldos_efectivo,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
1,AFISACBHEF,AFISACBHEF01,$TMPBOR.TMP_AFISACBHEF01,Filtro,INSERTTMP,WHERE,between,to_date(fec_posicion_efectivo),"date_add($FECHA_DATOS,-90) and date_add($FECHA_DATOS,10)",,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
1,AFISACBHEF,AFISACBHEF01,$TMPBOR.TMP_AFISACBHEF01,Grupo,INSERTTMP,GRUPO,"cve_sucursal,num_cuenta_contrato,cve_moneda,fec_posicion_efectivo",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
2,AFISACBHEF,AFISACBHEF02,$TMPBOR.TMP_AFISACBHEF02,Codigo,INSERTTMP,SELECT,"trim(acbh.cve_sucursal) br,trim(acbh.num_cuenta_contrato) accountno,trim(acbh.cve_moneda) ccy, acbh.fec_posicion_efectivo instrtdte,acbh.imp_posicion_efectivo origbalance",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
2,AFISACBHEF,AFISACBHEF02,$TMPBOR.TMP_AFISACBHEF02,Tabla,INSERTTMP,FROM,$AFOPICS.det_historial_saldos_efectivo acbh join $TMPBOR.TMP_AFISACBHEF01 acbh1 on acbh1.cve_sucursal = acbh.cve_sucursal and acbh1.num_cuenta_contrato = acbh.num_cuenta_contrato and acbh1.cve_moneda = acbh.cve_moneda and acbh1.fec_posicion_efectivo = acbh.fec_posicion_efectivo and acbh1.fec_particion_datos = acbh.fec_particion_datos,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
3,AFISACBHEF,AFISACBHEF03,$TMPBOR.TMP_AFISACBHEF03,Codigo,INSERTTMP,SELECT,"t.fch t_fch, t1.fch t1_fch, t2.fch t2_fch, t3.fch t3_fch, t4.fch t4_fch ",,,,,,,1,17/8/2021,17/8/2021,D,INICIAL,Tablas Primas 
3,AFISACBHEF,AFISACBHEF03,$TMPBOR.TMP_AFISACBHEF03,Tabla,INSERTTMP,FROM,$DMBOR.tmp_workdays t join $DMBOR.tmp_workdays t1 on t.days = t1.days-1 join $DMBOR.tmp_workdays t2 on t.days = t2.days-2 join $DMBOR.tmp_workdays t3 on t.days = t3.days-3 join $DMBOR.tmp_workdays t4 on t.days = t4.days-4,,,,,,,1,17/8/2021,17/8/2021,D,INICIAL,Tablas Primas 
3,AFISACBHEF,AFISACBHEF03,$TMPBOR.TMP_AFISACBHEF03,Filtro,INSERTTMP,WHERE,between,to_date(t.fch),"date_add($FECHA_DATOS,-90) and to_date($FECHA_DATOS)",,,,,1,17/8/2021,17/8/2021,D,INICIAL,Tablas Primas 
4,AFISACBHEF,AFISACBHEF04,$TMPBOR.TMP_AFISACBHEF04,Codigo,INSERTTMP,SELECT,*,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
4,AFISACBHEF,AFISACBHEF04,$TMPBOR.TMP_AFISACBHEF04,Tabla,INSERTTMP,FROM,"$TMPBOR.TMP_AFISACBHEF03 cross join (select distinct br, accountno, ccy from $TMPBOR.TMP_AFISACBHEF02) t",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
5,AFISACBHEF,AFISACBHEF05,$TMPBOR.TMP_AFISACBHEF05,Codigo,INSERTTMP,SELECT,"piv.br, piv.accountno, piv.ccy,piv.t_fch instrtdte_t, nvl(sdst.origbalance,0) origbalance_t,piv.t1_fch instrtdte_t1, nvl(sdst1.origbalance,0) origbalance_t1,piv.t2_fch instrtdte_t2, nvl(sdst2.origbalance,0) origbalance_t2,piv.t3_fch instrtdte_t3, nvl(sdst3.origbalance,0) origbalance_t3,piv.t4_fch instrtdte_t4, nvl(sdst4.origbalance,0) origbalance_t4",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
5,AFISACBHEF,AFISACBHEF05,$TMPBOR.TMP_AFISACBHEF05,Tabla,INSERTTMP,FROM,$TMPBOR.TMP_AFISACBHEF04 piv left join $TMPBOR.TMP_AFISACBHEF02 sdst on to_date(sdst.instrtdte) = to_date(piv.t_fch) and sdst.accountno = piv.accountno and sdst.br = piv.br and sdst.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF02 sdst1 on to_date(sdst1.instrtdte) = to_date(piv.t1_fch) and sdst1.accountno = piv.accountno and sdst1.br = piv.br and sdst1.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF02 sdst2 on to_date(sdst2.instrtdte) = to_date(piv.t2_fch) and sdst2.accountno = piv.accountno and sdst2.br = piv.br and sdst2.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF02 sdst3 on to_date(sdst3.instrtdte) = to_date(piv.t3_fch) and sdst3.accountno = piv.accountno and sdst3.br = piv.br and sdst3.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF02 sdst4  on to_date(sdst4.instrtdte) = to_date(piv.t4_fch) and sdst4.accountno = piv.accountno and sdst4.br = piv.br and sdst4.ccy = piv.ccy,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Codigo,INSERTTMP,SELECT,dpl.cve_valor as valor,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Tabla,INSERTTMP,FROM,$AFGBO.det_parametros_lumina dpl,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,WHERE,IN,fyh_particion_datos,(select max(dos.fyh_particion_datos) from $AFGBO.det_parametros_lumina dos where dos.fec_particion_datos = $FECHA_DATOS),,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,AND,=,fec_particion_datos,$FECHA_DATOS,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,AND,=,dpl.cve_objeto,'LUM-Refdata',,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,AND,=,dpl.cve_instrumento,21.4,,,,,1,17/8/2021,17/8/2021,D,INICIAL,Tablas Primas
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,AND,=,dpl.cve_sistema,931.25,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,AND,=,dpl.cve_sistema_fuente,931.25,,,,,1,17/8/2021,17/8/2021,D,INICIAL,Tablas Primas
6,AFISACBHEF,AFISACBHEF06,$TMPBOR.TMP_AFISACBHEF06,Filtro,INSERTTMP,AND,=,dpl.cve_llave,'FILTRO_CONTRATO',,,,,1,17/8/2021,17/8/2021,D,INICIAL,Tablas Primas
7,AFISACBHEF,AFISACBHEF07,$TMPBOR.TMP_AFISACBHEF07,Codigo,INSERTTMP,SELECT,"CASE WHEN ab.cod_entidad_legal = 'SAN-BCO' THEN '01'  WHEN ab.cod_entidad_legal = 'SAN-CB' THEN '02' END BR, ab.cod_cliente ACCOUNTNO, ab.nom_corto_instr CCY, ab.fec_balance INSTRTDTE, sum(cast(case when abs(ab.mto_ope) > 999999999999.9999 then 999999999999.9999 *(ab.mto_ope /-ab.mto_ope) else ab.mto_ope end as double)) ORIGBALANCE",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
7,AFISACBHEF,AFISACBHEF07,$TMPBOR.TMP_AFISACBHEF07,Tabla,INSERTTMP,FROM,$AFLUMINA.det_balance_cuentas ab,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
7,AFISACBHEF,AFISACBHEF07,$TMPBOR.TMP_AFISACBHEF07,Filtro,INSERTTMP,WHERE,=,ab.cod_tipo_activo,'CURRENCY',,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
7,AFISACBHEF,AFISACBHEF07,$TMPBOR.TMP_AFISACBHEF07,Filtro,INSERTTMP,AND,between,to_date(ab.fec_balance),"date_add($FECHA_DATOS,-90) and date_add($FECHA_DATOS,10)",,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
7,AFISACBHEF,AFISACBHEF07,$TMPBOR.TMP_AFISACBHEF07,Filtro,INSERTTMP,AND,NOT IN,ab.cod_cliente,(select VALOR from $TMPBOR.TMP_AFISACBHEF06),,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
7,AFISACBHEF,AFISACBHEF07,$TMPBOR.TMP_AFISACBHEF07,Grupo,INSERTTMP,GRUPO,"ab.cod_entidad_legal,ab.cod_cliente,ab.nom_corto_instr,ab.fec_balance",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
8,AFISACBHEF,AFISACBHEF08,$TMPBOR.TMP_AFISACBHEF08,Codigo,INSERTTMP,SELECT,*,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
8,AFISACBHEF,AFISACBHEF08,$TMPBOR.TMP_AFISACBHEF08,Tabla,INSERTTMP,FROM,"$TMPBOR.TMP_AFISACBHEF03 cross join (select distinct br, accountno, ccy from $TMPBOR.TMP_AFISACBHEF07) t",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
9,AFISACBHEF,AFISACBHEF09,$TMPBOR.TMP_AFISACBHEF09,Codigo,INSERTTMP,SELECT,"piv.br, piv.accountno, piv.ccy,piv.t_fch instrtdte_t, nvl(sdst.origbalance,0) origbalance_t,piv.t1_fch instrtdte_t1, nvl(sdst1.origbalance,0) origbalance_t1,piv.t2_fch instrtdte_t2, nvl(sdst2.origbalance,0) origbalance_t2,piv.t3_fch instrtdte_t3, nvl(sdst3.origbalance,0) origbalance_t3,piv.t4_fch instrtdte_t4, nvl(sdst4.origbalance,0) origbalance_t4",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
9,AFISACBHEF,AFISACBHEF09,$TMPBOR.TMP_AFISACBHEF09,Tabla,INSERTTMP,FROM,$TMPBOR.TMP_AFISACBHEF08 piv left join $TMPBOR.TMP_AFISACBHEF07 sdst on to_date(sdst.instrtdte) = to_date(piv.t_fch) and sdst.accountno = piv.accountno and sdst.br = piv.br and sdst.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF07 sdst1 on to_date(sdst1.instrtdte) = to_date(piv.t1_fch) and sdst1.accountno = piv.accountno and sdst1.br = piv.br and sdst1.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF07 sdst2 on to_date(sdst2.instrtdte) = to_date(piv.t2_fch) and sdst2.accountno = piv.accountno and sdst2.br =piv.br and sdst2.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF07 sdst3 on to_date(sdst3.instrtdte) = to_date(piv.t3_fch) and sdst3.accountno = piv.accountno and sdst3.br = piv.br and sdst3.ccy = piv.ccy left join $TMPBOR.TMP_AFISACBHEF07 sdst4 on to_date(sdst4.instrtdte) = to_date(piv.t4_fch) and sdst4.accountno = piv.accountno and sdst4.br = piv.br and sdst4.ccy = piv.ccy,,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
10,AFISACBHEF,AFISACBHEF10,$DMBOR.MST_AFISACBHEF10,Codigo,INSERTTMP,SELECT,"br, accountno, ccy, date_format(instrtdte_t, 'yyyyMMdd') instrtdte_t, printf('%1.2f', sum(origbalance_t)+0) origbalance_t,date_format(instrtdte_t1, 'yyyyMMdd')instrtdte_t1, printf('%1.2f', sum(origbalance_t1)+0) origbalance_t1,date_format(instrtdte_t2, 'yyyyMMdd') instrtdte_t2,printf('%1.2f', sum(origbalance_t2)+0) origbalance_t2,date_format(instrtdte_t3, 'yyyyMMdd') instrtdte_t3, printf('%1.2f', sum(origbalance_t3)+0) origbalance_t3,date_format(instrtdte_t4, 'yyyyMMdd') instrtdte_t4, printf('%1.2f', sum(origbalance_t4)+0) origbalance_t4",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
10,AFISACBHEF,AFISACBHEF10,$DMBOR.MST_AFISACBHEF10,Tabla,INSERTTMP,FROM,"(select br, accountno, ccy, instrtdte_t, origbalance_t, instrtdte_t1, origbalance_t1, instrtdte_t2, origbalance_t2, instrtdte_t3, origbalance_t3, instrtdte_t4, origbalance_t4 from $TMPBOR.TMP_AFISACBHEF09 union all select br, accountno, ccy, instrtdte_t, origbalance_t, instrtdte_t1, origbalance_t1, instrtdte_t2, origbalance_t2, instrtdte_t3, origbalance_t3, instrtdte_t4, origbalance_t4 from $TMPBOR.TMP_AFISACBHEF05) t",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
10,AFISACBHEF,AFISACBHEF10,$DMBOR.MST_AFISACBHEF10,Grupo,INSERTTMP,GRUPO,"br, accountno, ccy, instrtdte_t, instrtdte_t1, instrtdte_t2, instrtdte_t3, instrtdte_t4",,,,,,,1,16/4/2021,16/4/2021,D,INICIAL,RPT_BOFA
